# .github/workflows/register_flow.yml
name: MediaFire æ‰¹é‡æ³¨å†Œæµ

on:
  # å¯ä»¥é€‰æ‹©æ‰‹åŠ¨è§¦å‘ï¼Œæˆ–è€…æ ¹æ®æ‚¨çš„éœ€æ±‚è®¾ç½®ä¸ºå®šæ—¶ä»»åŠ¡
  workflow_dispatch:
    inputs:
      # æ‰‹åŠ¨è¾“å…¥è¿è¡Œæ¬¡æ•°ï¼Œä¹Ÿå¯ä»¥å†™æ­»åœ¨ env ä¸­
      count:
        description: 'é‡å¤æ³¨å†Œçš„æ¬¡æ•°'
        required: true
        default: '5'
      
jobs:
  batch_registration:
    runs-on: ubuntu-latest

    steps:
      - name: â¬‡ï¸ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: ğŸ è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: âš™ï¸ å®‰è£…ä¾èµ–
        run: pip install -r requirements.txt

      - name: ğŸš€ æ‰§è¡Œæ³¨å†Œè„šæœ¬
        # è®¾ç½®æ‰€æœ‰éœ€è¦çš„ç¯å¢ƒå˜é‡
        env:
          # ----------------- å¯å…¬å¼€é…ç½®çš„ URL å’Œæ¬¡æ•° -----------------
          MAIL_LOGIN_URL: 'https://mail.928090.xyz/'
          MEDIAFIRE_REGISTER_URL: 'https://www.mediafire.com/?nnfhfnh'
          REGISTRATION_COUNT: ${{ github.event.inputs.count }} # ä½¿ç”¨æ‰‹åŠ¨è¾“å…¥çš„æ¬¡æ•°

          # ----------------- æ•æ„Ÿä¿¡æ¯ (æ¥è‡ª Secrets) -----------------
          MAIL_USERNAME: ${{ secrets.MAIL_USERNAME }}
          MAIL_PASSWORD: ${{ secrets.MAIL_PASSWORD }}
          ACCOUNT_PASSWORD: ${{ secrets.ACCOUNT_PASSWORD }}

        run: python main.py
